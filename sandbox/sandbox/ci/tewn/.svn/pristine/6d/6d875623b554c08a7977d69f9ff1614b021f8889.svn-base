<?php

namespace Test\Cron;
use CI\Cron\Controller;

class CronControllerTest extends \PHPUnit_Framework_TestCase
{
    protected $aOptions = array(
        'cron'    => 'example',
        'command' => 'run',
        'params'  => array(),
    );

    public function testCreateControllerAndRun()
    {
        $oController = new Controller($this->aOptions);
        
        $this->expectOutputString('Example Done');
        $oController->run();
    }

    public function testCreateControllerWithtwoClassNameAndRun()
    {
        $this->aOptions['cron'] = 'cron_example';
        $oController = new Controller($this->aOptions);
        
        $this->expectOutputString('Cron Example Done');
        $oController->run();
    }

    public function testExceptionWhenClassNameNotFound()
    {
        $this->setExpectedException('\CI\Cron\Exception');
        $this->aOptions['cron'] = 'non_existing_class';
        $oController = new Controller($this->aOptions);
    }

    public function testExceptionWhenCommandNameNotFound()
    {
        $this->setExpectedException('\CI\Cron\Exception');
        unset($this->aOptions['command']);
        $oController = new Controller($this->aOptions);
        $oController->run();
    }
}

namespace CI\Cron;

class Example extends \CI\Cron
{
    public function runCommand()
    {
        echo "Example Done";
    }
}

class CronExample extends \CI\Cron
{
    public function runCommand()
    {
        echo "Cron Example Done";
    }
}