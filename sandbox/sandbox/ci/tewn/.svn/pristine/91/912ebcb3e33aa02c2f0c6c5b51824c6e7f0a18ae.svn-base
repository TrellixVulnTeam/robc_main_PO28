<?php

namespace CI\Model;

abstract class Cake
{
    protected $oModel;
    protected $aRequiredMethods;

    public function __construct($oModel)
    {
        $this->setCakeModel($oModel);
    }

    public function setCakeModel($oCake)
    {
        if ($this->validateModel($oCake)) {
            $this->oModel = $oCake;
        } else {
            throw new \CI\Model\Cake\Exception(\CI\Model\Cake\Exception::NOT_VALID);
        }
    }

    protected function validateModel($oModel)
    {
        $aMethods = get_class_methods($oModel);

        if (null === $aMethods) {
            // not a class
            return false;
        }

        if (empty($this->aRequiredMethods)) {
            $this->aRequiredMethods = array('find', 'query_read');
        }

        $aMethodsFound = array_intersect($this->aRequiredMethods, $aMethods);

        return $this->aRequiredMethods == $aMethodsFound;
    }
}