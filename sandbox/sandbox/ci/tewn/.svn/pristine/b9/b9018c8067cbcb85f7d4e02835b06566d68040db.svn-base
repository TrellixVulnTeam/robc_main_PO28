<?php
/* SVN FILE: $Id$ */
/* Account Test cases generated on: 2010-03-08 07:18:38 : 1268054318*/
class AccountTestCase extends CakeTestCase {
	var $Account = null;
	var $fixtures = array('app.account');

	function startTest() {
		$this->Account =& ClassRegistry::init('Account');
	}

	function testAccountInstance() {
		$this->assertTrue(is_a($this->Account, 'Account'));
	}

	function testAccountFind() {
		$this->Account->recursive = -1;
		$results = $this->Account->find('first', array(
				'order' => 'id ASC'
			));

		$this->assertTrue(!empty($results));

		$expected = array('Account' => array(
			'id' => 1,
			'website_id' => 1,
			'offer_id' => 0,
			'status' => 0,
			'credits' => 1500,
			'incoming' => 0,
			'outgoing' => 0,
			'transfer_account_id' => 0,
			'rate' => 1.2,
			'created' => '2010-03-08 07:18:35',
			'visible' => 1,
			'user_id' =>1,
			'domain_bitfield' =>1,
			'featured'=>NULL,
			'paid'=>0,
			'buying'=>0,
			'refer_id'=>2,
			'landing_page_rebalance'=>NULL,
			'refer_transfer_rate' => 1,
			'widget_rebalance'=>'2011-10-12 13:55:43'
		));
		$this->assertEqual($results, $expected);
	}

	function testGetByRefer() {
		$accounts = $this->Account->findAllByUserId(1);
		$refers = $this->Account->get_by_refer($accounts);

		$this->assertEqual(count($refers), 8);
		foreach ($refers as $refer) {
			$refer_ids[] = $refer['Account']['refer_id'];
		}
		$this->assertTrue(in_array(2, $refer_ids));
		$this->assertTrue(in_array(3, $refer_ids));
	}
}
?>