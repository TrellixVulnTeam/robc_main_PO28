<?php
$javascript->link('bootstrap/ci/imagepreview', false);
$javascript->link('bootstrap/external/cropper', false);
$javascript->link('bootstrap/external/jquery.validate', false);
$javascript->link('bootstrap/page/custom', false);
$html->css('bootstrap/external/bootstrap-panel', 'stylesheet', null, false);
$html->css('bootstrap/page/custom', 'stylesheet', null, false);
$html->css('bootstrap/external/cropper', 'stylesheet', null, false);
?>
<div class="container right-content">
    <?php echo $breadcrumbs_component;?>
    <form id="form-add-custom-page" role="form">
        <div class="row">
            <div class="col-md-4">
            <?php if (!empty($article)) : ?>
                <input type="hidden" name="id" value="<?php echo $article['id'] ?>">
            <?php endif; ?>
                <div class="form-group">
                    <label for="headline" class="control-label">Headline</label>
                    <input id="headline" name="headline" type="text" class="form-control" value="<?php echo (isset($article['headline']) ? htmlentities($article['headline']) : ''); ?>">
                </div>
                <div class="form-group">
                    <label>Publication Date</label>
                    <?php echo $range_date_component; ?>
                </div>
                <div class="form-group">
                    <label for="abstract" class="control-label">Abstract</label>
                    <textarea id="abstract" name="body_text" class="form-control" rows="6"><?php echo (isset($article['body_text']) ? htmlentities($article['body_text']) : ''); ?></textarea>
                </div>
                <div class="form-group">
                    <label for="readmore_link" class="control-label">Article URL</label>
                    <input id="readmore_link" name="readmore_link" type="url" class="form-control" placeholder="http://www.example.com" value="<?php echo (isset($article['readmore_link']) ? htmlentities($article['readmore_link']) : ''); ?>">
                </div>
                <div class="form-group">
                    <div>
                        <label>Website:</label>
                        <span><?php echo $website['Website']['name'];?></span>
                    </div>
                    <div>
                        <label>Website Status:</label>
                        <span><?php echo $website['Website']['status_name'];?></span>
                    </div>
                <?php if (isset($article['url'])) : ?>
                    <div>
                        <label>Article URL:</label>
                        <span><a href="<?php echo $article['url']; ?>" target="_blank"><?php echo $article['url']; ?></a></span>
                    </div>
                <?php endif; ?>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label>Domain</label>
                    <?php echo $hubs_select_component;?>
                </div>
                <div class="form-group">
                    <label>Sex</label>
                    <?php echo $demographic_select_component;?>
                </div>
                <div class="form-group">
                    <label>Content Rating</label>
                    <?php echo $content_rating_select_component;?>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <?php echo $categories_select_component;?>
                </div>
            <?php if (isset($article['id'])) : ?>
                <div class="form-group">
                    <label>Status</label>
                    <select name="status" class="selectpicker show-tick" data-width="100%">
                        <option value="<?php echo \CI\Article::STATUS_ACTIVE; ?>" <?php echo (\CI\Article::STATUS_ACTIVE == $article['status']) ? 'selected' : '' ?>>Active</option>
                        <option value="<?php echo \CI\Article::STATUS_PAUSED; ?>" <?php echo (\CI\Article::STATUS_PAUSED == $article['status']) ? 'selected' : '' ?>>Paused</option>
                    </select>
                </div>
            <?php endif; ?>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label>Add a Image</label>
                    <div id="pane-add-image" class="panel with-nav-tabs panel-default" data-preview-selector="#preview-container" data-image-selector="#image-container">
                        <div class="panel-heading">
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#url" data-toggle="tab">From URL</a></li>
                                <li><a href="#local" data-toggle="tab">From Computer</a></li>
                            </ul>
                        </div>
                        <div class="panel-body">
                            <div class="tab-content<?php echo isset($article['image']) ? ' hidden' : ''; ?>">
                                <div class="tab-pane fade in active" id="url">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input id="txt-get-image" type="text" name="image_url" class="form-control" value="<?php echo (isset($article['image']) ? htmlentities($article['image']) : ''); ?>">
                                            <span class="input-group-btn">
                                            <button id="btn-get-image" class="btn btn-default" type="button">Get Image</button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="local">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input type="text" class="form-control" readonly>
                                            <span class="input-group-btn">
                                            <span class="btn btn-default btn-file">
                                            Browse <input id="input-upload-image" type="file" data-url="/custom_landing_page/action/upload_image">
                                            </span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="progress hidden">
                                <div id="progress-bar" class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
                                    <span>0%</span>
                                </div>
                            </div>
                            <?php
                                $btn_class = isset($article['image']) ? '' : ' hidden';
                            ?>
                            <button id="btn-change-img" type="button" class="btn btn-default btn-block <?php echo $btn_class; ?>">Change Image</button>
                            <button id="btn-crop-img" type="button" class="btn btn-default btn-block <?php echo $btn_class; ?>">Crop Image</button>
                            <button id="btn-cancel-crop-img" type="button" class="btn btn-default btn-block hidden">Cancel Crop Image</button>
                            <input id="image"  name="image" type="hidden"  value="<?php echo (isset($article['image']) ? htmlentities($article['image']) : ''); ?>">
                            <input id="input-website-id"  name="website_id" type="hidden" value="<?php echo $website_id; ?>">
                        </div>
                    </div>
                    <div id="image-container" class="thumbnail">
                        <img src="<?php echo (isset($article['image']) ? $article['image_preview'] : 'http://placehold.it/349x199&text=Preview'); ?>">
                    </div>
                    <div class="thumbnail hidden">
                        <div id="preview-container"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <div class="form-group">
                <?php if (isset($article['id'])) : ?>
                    <button id="btn-edit-page" type="submit" class="btn btn-primary active" data-loading-text="Saving ...">Update</button>
                <?php else : ?>
                    <button id="btn-add-page" type="submit" class="btn btn-primary active" data-loading-text="Saving ...">Add</button>
                <?php endif; ?>
                </div>
            </div>
        </div>
    </form>
</div>