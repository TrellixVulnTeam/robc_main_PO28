<?php
/**
 * Http Server global
 *
 * PHP Version 5.4
 *
 * @category CI
 * @package  CI\Http
 * @author   Julio Rodriguez <julio.rodriguez@evolvemediallc.com>
 * @license  Evolve Media LLC
 * @link     http://crowdignite.com
 */

namespace CI\Http;

/**
 * Http Server global
 *
 * PHP Version 5.4
 *
 * @category CI
 * @package  CI\Http
 * @author   Julio Rodriguez <julio.rodriguez@evolvemediallc.com>
 * @license  Evolve Media LLC
 * @link     http://crowdignite.com
 */
class Server
{
    protected $aServer = array();

    public function __construct()
    {
        if (!empty($_SERVER)) {
            $this->aServer = $_SERVER;
        }
    }

    public function getElement($sKey)
    {
        $sReturn = null;

        if (!empty($this->aServer[$sKey])) {
            $sReturn = $this->aServer[$sKey];
        }

        return $sReturn;
    }

    /**
     * Get the current url
     * @return string The current uri string
     */
    public function getCurrentUrl()
    {
        $sUrl  = 'http://';
        $sUrl .= $this->getElement('HTTP_HOST');
        $sUrl .= $this->getElement('REQUEST_URI');
        return $sUrl;
    }

    /**
     * Get the client's IP addres
     *
     * @param  boolean $bCheckProxy
     *
     * @return string
     */
    public function getClientIp($bCheckProxy = true)
    {
        $sReturn = $this->getAllClientIps($bCheckProxy);
        $sReturn = explode(',', $sReturn);
        $sReturn = trim(array_shift($sReturn));

        return $sReturn;
    }

    /**
     * Get all the client's IP addres included Proxys if this exists
     *
     * @param  boolean $bCheckProxy
     *
     * @return string
     */
    public function getAllClientIps($bCheckProxy = true)
    {
        $sReturn = '';

        if ($bCheckProxy && $this->getElement('HTTP_CLIENT_IP') != null) {
            $sReturn = $this->getElement('HTTP_CLIENT_IP');
        } else if ($bCheckProxy && $this->getElement('HTTP_X_FORWARDED_FOR') != null) {
            $sReturn = $this->getElement('HTTP_X_FORWARDED_FOR');
        } else {
            $sReturn = $this->getElement('REMOTE_ADDR');
        }

        return $sReturn;
    }
}