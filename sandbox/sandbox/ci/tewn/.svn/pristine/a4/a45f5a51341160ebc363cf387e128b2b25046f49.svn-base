<?php

App::import('Controller', 'Actions');

class DevelopersReportsActionsController extends ActionsController
{
    public $name = 'DevelopersReportsActions';
    public $uses = array('WidgetAnalytic', 'Page');

    protected $permissions = array(
        'fix_wrong_widget_analytics' => User::DEVS
    );

    public function fix_wrong_widget_analytics()
    {
        $params          = new CI\ArrayManipulator($this->params['url']);
        $website_id      = $params->get('website_id', 0);
        $domain_bitfield = $params->get('domain_bitfield', 0);

        $api = new CI\Api\Response();
        $url = sprintf("/widget_analytics/domain_bits_set/%d/%d", $website_id, $domain_bitfield);
        $this->requestAction($url);
        $api->addData('website_id', $website_id);
        $api->addData('domain_bitfield', $domain_bitfield);
        echo $api->get();
    }
}