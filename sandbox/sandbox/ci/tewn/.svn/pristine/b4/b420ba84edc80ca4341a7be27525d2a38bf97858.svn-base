<?php
/**
 * Words Number File
 *
 * PHP Version 5.3
 *
 * @author   Francisco Gonzalez <francisco.gonzalez@evolvemediallc.com>
 * @license  Evolve Media LLC
 * @link     http://www.crowdignite.com
 */

namespace CI\Filter\String;
use \CI\String\Exception as StringException;

/**
 * Words Number Class
 *
 * PHP Version 5.3
 *
 * @author   Francisco Gonzalez <francisco.gonzalez@evolvemediallc.com>
 * @license  Evolve Media LLC
 * @link     http://www.crowdignite.com
 */
class WordsNumber implements \CI\Filter
{
    protected $nWords = 0;

    /**
     * Sets the number of words for the string
     *
     * @param int $nWords Number of words
     *
     * @return CI\Filter\String\WordLimit
     */
    public function setWords($nWords)
    {
        $this->nWords = (int) $nWords;
        return $this;
    }

    /**
     * Filters the $value
     *
     * @param string $sValue The value to be filtered
     *
     * @return string The filtered value
     */
    public function filter($sValue)
    {
        if (false === is_string($sValue)) {
            throw new StringException(StringException::NOT_VALID, gettype($sValue));
        }

        if (0 >= $this->nWords) {
            throw new StringException(StringException::INVALID_WORDS_NUMBER);
        }

        $aWords = explode(' ', $sValue);

        if (count($aWords) > $this->nWords) {
            $sValue = implode(' ', array_slice($aWords, 0, $this->nWords)) . '...';
        }

        return $sValue;
    }
}