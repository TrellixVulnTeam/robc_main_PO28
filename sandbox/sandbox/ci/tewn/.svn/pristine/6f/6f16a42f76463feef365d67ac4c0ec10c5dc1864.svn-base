<?php

namespace CI\Filter\String;
use \CI\String\Exception as StringException;

/**
 * Filter to truncate a string when exceeds the number of
 * characters set by StringTruncate::setLength
 *
 * PHP Version 5.3
 *
 * @category Filter
 * @package  CI\Filter\String
 * @author   Jorge Rodriguez <jorge.rodriguez@evolvemediallc.com>
 * @license  Evolve Media LLC
 * @link     http://crowdignite.com
 */
class Truncate implements \CI\Filter
{
    private $_nLength = 0;

    /**
     * Sets the number of characters to filter a string
     * @param int $nLength Number of characters
     */
    public function setLength($nLength)
    {
        $this->_nLength = (int) $nLength;
        return $this;
    }

    /**
     * Gets the number of characters to filter a string
     * @return int Number of characters
     */
    public function getLength()
    {
        return $this->_nLength;
    }

    /**
     * Filters the $value
     * @param string $sValue The value to be filtered
     * @return string The filtered value
     */
    public function filter($sValue)
    {
        if (false === is_string($sValue)) {
            throw new StringException(StringException::NOT_VALID, gettype($sValue));
        }

        if (0 >= $this->_nLength) {
            throw new StringException(StringException::INVALID_LENGTH);
        }

        return substr($sValue, 0, $this->_nLength);
    }
}