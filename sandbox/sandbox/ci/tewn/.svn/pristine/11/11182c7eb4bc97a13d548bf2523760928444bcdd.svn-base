<?php

namespace CI\Validator\Excel;

class Formats extends \CI\Validator\Rule
{
    const INVALID = 'invalid';

    protected $aFormats = array();

    protected $aMessageTemplates = array(
        self::INVALID  => "Invalid Format: [%value%]",
    );

    public function __construct()
    {
        $this->aFormats = array(
            \CI\Excel\Settings::FORMAT_NUMBER_COMMA_SEPARATED1             => true,
            \CI\Excel\Settings::FORMAT_NUMBER_COMMA_SEPARATED1_NO_DECIMALS => true,
            \CI\Excel\Settings::FORMAT_PERCENTAGE_00                       => true,
        );
    }

    public function isValid($mValue)
    {
        $bReturn = true;
        $this->setValue($mValue);

        if (!isset($this->aFormats[$mValue])) {
            $bReturn = false;
            $this->error(self::INVALID);
        }

        return $bReturn;
    }
}