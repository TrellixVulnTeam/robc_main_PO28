<?php

namespace Test\Validator\Excel;

/**
 * @group Excel
 */
class SettingsTest extends \PHPUnit_Framework_TestCase
{
    /**
     * @dataProvider getTests
     */
    public function testSetting($mOption, $bExpected)
    {
        $oSettings = new \CI\Validator\Excel\Settings();
        $bResult = $oSettings->isValid($mOption);
        $this->assertEquals($bExpected, $bResult,  print_r($oSettings->getErrors(), true));
    }

    public function getTests()
    {
        return array(
            array(
                array(
                    'Document' => array(
                        'title' => 'Report by hub 12/12/12',
                        'creator' => 'Juan Perez',
                        'font_size' => 1,
                        'font_style' => 'Times Roman'
                    ),
                    'Sheets' => array(
                        'game_revolution' => array(
                            'Columns' => array(
                                '_name_' => array(
                                    'title' => 'Names',
                                    'format' => '0.00%'
                                )
                            ),
                            'title' => 'Game Revolution'

                        ),
                        'tottaly_her' => array(
                            'title' => 'Totally Her'
                        )
                    ),
                ),
                true
            ),
            array(
                array(
                    'Document' => array(
                        'title' => 'Report by hub 12/12/12',
                        'creator' => 'Juan Perez',
                        'font_size' => 1,
                        'font_style' => 'Times Roman',
                        'ritoooooo' => 'Juan'
                    ),
                    'Sheets' => array(
                        array(
                            'title' => 'Game Revolution'
                        ),
                        array(
                            'title' => 'Game Revolution2',
                            'Columns' => array(
                                '_name_' => array(
                                    'title' => 'Names',
                                    'format' => '0.00%'
                                )
                            )
                        )
                    )
                ),
                false
            ),
            array(
                array(
                    'Document' => array(
                        'title' => 'Report by hub 12/12/12',
                        'creator' => 'Juan Perez',
                        'font_size' => 2,
                        'font_style' => 'Times Roman'
                    ),
                ),
                true
            ),
            array(
                array(
                    'Sheets' => array(
                        array(
                            'title' => 'Game Revolution'
                        )
                    ),
                ),
                true
            ),
            array(
                array(
                    'Document' => array(
                        'title' => 'Report by hub 12/12/12',
                        'creator' => 'Juan Perez',
                        'font_size' => 4,
                        'font_style' => 'Times Roman'
                    ),
                    'Sheets' => array(
                        array(
                            'title' => 'Game Revolution'
                        )
                    ),
                    'Columns' => array(
                        '_name_' => array(
                            'title' => 'Names',
                            'format' => '-------------',
                        )
                    )
                ),
                false
            ),
            array(
                array(
                    'Document' => array(
                        'title' => 'Report by hub 12/12/12',
                        'creator' => 'Juan Perez',
                        'font_size' => 5,
                        'font_style' => 'Times Roman'
                    ),
                    'Sheets' => array(
                        array(
                            'title' => 'Game Revolution'
                        )
                    ),
                    'Does_not_exist' => array()
                ),
                false
            ),
        );
    }
}