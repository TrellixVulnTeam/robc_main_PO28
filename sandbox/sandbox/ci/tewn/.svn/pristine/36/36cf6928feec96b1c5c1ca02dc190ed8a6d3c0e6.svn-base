$(function () {
    var tplLogResults = Handlebars.compile($new('#tpl_results_data').html());
    function get_logs() {
        var page = $(this).data('page') || 1;
        var type = $new('#filters_select').val();
        var loading = $new('#logs_loading').html();
        $new('#results_data').html(loading);
        $new.get('/metric_logs/action/get_logs', {
            type: type,
            page: page
        }, function (data) {
            if (data.status == 'ok') {
                $new('#results_data').html(tplLogResults(data));
            } else {
                $new('#results_data').html('Error! no results, please try again...');
            }
        }, 'json');
    }

    $new('#filters_select').on('change', get_logs);
    $new('#results_data').on('click', 'div.pagination a', function () {
        get_logs.apply(this);
        return false;
    });
    get_logs();
});