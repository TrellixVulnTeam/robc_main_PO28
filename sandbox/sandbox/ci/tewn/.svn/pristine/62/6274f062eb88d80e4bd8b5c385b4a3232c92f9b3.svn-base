<?php
/**
 * Capitalize File
 *
 * PHP Version 5.3
 *
 * @author   Francisco Gonzalez <francisco.gonzalez@evolvemediallc.com>
 * @license  Evolve Media LLC
 * @link     http://www.crowdignite.com
 */

namespace CI\Filter\String;
use \CI\String\Exception as StringException;

/**
 * Capitalize Class
 *
 * PHP Version 5.3
 *
 * @author   Francisco Gonzalez <francisco.gonzalez@evolvemediallc.com>
 * @license  Evolve Media LLC
 * @link     http://www.crowdignite.com
 */
class Capitalize implements \CI\Filter
{
    protected $aExclude = array(
        'a',
        'an',
        'the',
        'and',
        'but',
        'or',
        'for',
        'nor',
    );

    public function filter($sValue)
    {
        if (false === is_string($sValue)) {
            throw new StringException(StringException::NOT_VALID, gettype($sValue));
        }

        if (!empty($sValue)) {
            $aWords = explode(' ', $sValue);

            foreach ($aWords as $nIndex => $sWord) {
                $bExclude = in_array(strtolower($sWord), $this->aExclude);
                if (!empty($sWord) && (0 === $nIndex || $nIndex > 0 && !$bExclude)) {
                    $sWord[0] = strtoupper($sWord[0]);
                    $aWords[$nIndex] = $sWord;
                }
            }

            $sValue = implode(' ', $aWords);
        }

        return $sValue;
    }
}