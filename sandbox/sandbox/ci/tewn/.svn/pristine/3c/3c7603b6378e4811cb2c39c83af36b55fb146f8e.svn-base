<link rel="stylesheet" type="text/css" href="/css/tablesort.css">
</script><script type="text/javascript" src="/js/jquery.tablesorter.js"></script>
<script type="text/javascript">

jQuery(document).ready(function() { 						 
	jQuery.tablesorter.addParser({
	id: "commaDigit",
	is: function(s, table) {
		var c = table.config;
		return jQuery.tablesorter.isDigit(s.replace(/,/g, ""), c);
		},
	format: function(s) {
		return jQuery.tablesorter.formatFloat(s.replace(/,/g, ""));
	},
	type: "numeric"
	});

	$("#users_table").tablesorter();

});

</script>

<div class="row main">
	<div id="content" class="column grid_12">
		<?
			echo $this->element("management_toolbar", array("tab" => "subcategories", "user" => $user));
		?>
		<div class="row">
			<div class="column grid_12">
				<h3 class="topContent">Subcategory Management</h3>
			</div>
			<div class="row" id="content_area">				
				<div class="column grid_12">
					<? 
						$session->activate(); 
						if ($session->check('Message.flash')) {
							$session->flash();
						}
					?>
					<div style="margin-left:30px;margin-top:18px;">
						<div  style="margin-top:20px;">
							<?        
							echo $form->create('Tags', array('action' => 'create',
								'type' => 'Post',
								'url' => '/management/subcategories'));
							echo $form->hidden('Tag.type', array('value' => TAG_TYPE_SUBCATEGORY));
							?>

								<table border=0>
									<tr>
										<td>Name</td>
										<td>
											<?
											echo $form->text('Tag.name', array('size' => '20'));
											echo $form->error('Tag.name', NULL, array('class' => 'error_message'));
											?>
										</td>
									</tr>
									<tr>
										<td>Category</td>
										<td>
											<?
											$categories = $convert->category_select();
											echo $form->select('Tag.parent', $categories);
											?>
										</td>
									</tr>
									<tr>
										<td colspan=2>
											<center>
												<?
												echo $form->submit("Create");
												?>
											</center>
										</td>
									</tr>
								</table>
							</form>
						</div>
					</div>
					<div style="margin-left:30px;margin-top:18px;">			
						<center>
							<table id="subcategories_table" class="tablesorter" cellpadding="1" width=100% cellspacing="0" border=1 style="padding: 2px 4px 2px 4px; border: 1px solid #660000;">
								<thead>
									<tr>
										<th>ID</th>
										<th>Name</th>
										<th>Category</th>
										<th>Created</th>
									</tr>						
								</thead>
								<tbody>
									<? 
									foreach($subcategories as $sub){
										$parent = $convert->category($sub['Tag']['parent']);
										echo "<tr><td>".$sub["Tag"]["id"]."</td>";
										echo "<td>".$sub["Tag"]["name"]."</td>";
										echo "<td>".$parent."</td>";
										echo "<td>".$sub["Tag"]["created"]."</td>";
									} 										
									?>
								</tbody>
							</table>
							
						</center>
					</div>
				</div>
				
			</div>
		</div>